#! /home/andreas/src/c/stubforth/stubforth
.( this is ) hi
.( mmaped dataspace used: )
here ?word forget - . .( bytes) lf
.( cell size of your build: ) cell . .( bytes) lf
.( cell alignment of your build: ) 1 aligned . .( bytes) lf
.( argc: ) 	argc ? lf
.( optind: ) 	optind ? lf

: dumpargs
	dup if
		dup 1- recurse
	then
	." argv + " dup . ." : "
	cells argv @ + @ type lf
;

argc @ 1- dumpargs

.( testing dlopen... ) lf

" /lib/libc.so.6" dlopen constant libc

: cbind ( handle sym nargs -- )
	<builds , dlsym ,
  does>	2@ call	;

libc " printf" 0 cbind printf
libc " getpid" 0 cbind getpid
libc " system" 1 cbind system
libc " puts" 1 cbind puts
libc " getchar" 0 cbind getchar
libc " kill" 2 cbind kill
libc " getopt" 3 cbind getopt

.( getpid => ) getpid . lf

.( mmaped dataspace used: )
here ?word forget - . .( bytes) lf

0 redirect !

